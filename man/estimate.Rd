% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dml.R
\name{estimate}
\alias{estimate}
\title{Compute pseudo outcome components \code{a} and \code{b} and their product \code{v}}
\usage{
estimate(testing_data, outcome, treatment, sample, pi, pi_m, e_m)
}
\arguments{
\item{testing_data}{A \code{data.frame} that contains at least outcome, treatment, and sample indicator columns.}

\item{outcome}{A \code{character(1)} name of the outcome column in \code{testing_data}.}

\item{treatment}{A \code{character(1)} name of the treatment column in \code{testing_data} with values \code{0} or \code{1}.}

\item{sample}{A \code{character(1)} name of the sample indicator column in \code{testing_data} with values \code{0} or \code{1}.}

\item{pi}{A \code{numeric(1)} giving the estimated prevalence \eqn{P(S=1)} from the training data.}

\item{pi_m}{A fitted \code{glm} model for \eqn{P(S=1 \mid X)}.}

\item{e_m}{A fitted \code{glm} model for \eqn{P(Tr=1 \mid X, S=1)}.}
}
\value{
A \code{list} with \code{numeric} vectors of length \code{nrow(testing_data)}:
\item{v}{Pseudo outcome values.}
\item{a}{IPW adjusted outcome contrast.}
\item{b}{Overlap weight factors.}
}
\description{
Uses nuisance model outputs to compute inverse probability weighted quantities for ATE in the trial sample.
}
\details{
Predictions from \code{pi_m} and \code{e_m} are clamped to \code{[1e-8, 1 - 1e-8]} for stability.
}
