% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dml.R
\name{estimate}
\alias{estimate}
\title{Compute pseudo-outcome components (a, b) and their product (v)}
\usage{
estimate(testing_data, outcome, treatment, sample, pi, pi_m, e_m)
}
\arguments{
\item{testing_data}{A data frame of test data (or evaluation data) containing at least the columns for outcome, treatment, and sample indicators.}

\item{outcome}{Name of the outcome column in \code{testing_data}.}

\item{treatment}{Name of the treatment column in \code{testing_data} (0/1).}

\item{sample}{Name of the sample indicator column in \code{testing_data} (0/1).}

\item{pi}{Numeric scalar, the estimated \eqn{P(S=1)} (prevalence) from the training data.}

\item{pi_m}{A fitted model (e.g., \code{glm}) for \eqn{P(S=1 \mid X)}; typically from \code{train()}.}

\item{e_m}{A fitted model (\code{glm}) for \eqn{P(Tr=1 \mid X, S=1)}; typically from \code{train()}.}
}
\value{
A list with numeric vectors:
\item{v}{Pseudo-outcome values for each observation (numeric vector length = nrow(testing_data)).}
\item{a}{Intermediate "IPW-adjusted outcome" values (same length as v).}
\item{b}{Overlap weight factors (same length as v).}
}
\description{
Using the outputs of the nuisance models, computes intermediate values for the
treatment effect estimation via inverse probability weighting (IPW) for the Average Treatment Effect (ATE) in trial sample.
}
\details{
Specifically, it computes:
\itemize{
\item \code{a}: IPW-adjusted outcome difference, \eqn{a_i = S_i \left(\frac{Tr_i Y_i}{p_{t1|x,i}} - \frac{(1-Tr_i) Y_i}{1 - p_{t1|x,i}}\right)}.
\item \code{b}: Overlap weight factor, \eqn{b_i = \frac{1}{\ell(X_i)}}, where \eqn{\ell(X) = \frac{P(S=1|X)/\pi}{P(S=0|X)/(1-\pi)}}.
\item \code{v}: The pseudo-outcome, defined as \eqn{v_i = a_i \times b_i}.
}

The predicted probabilities from \code{pi_m} and \code{e_m} are constrained to \verb{[1e-8, 1-1e-8]} to avoid instability (extremely small or large probabilities are clamped).
If the provided \code{pi} is 0 or 1 (indicating no variation in sample inclusion in training), the computation is undefined and an error will be thrown.
Ensure that \code{pi_m} and \code{e_m} correspond to models trained on compatible data (same covariates) for accurate predictions.
}
\seealso{
\code{\link{train}} for obtaining \code{pi}, \code{pi_m}, and \code{e_m}; \code{\link{estimate_dml}} for cross-fitted estimation.
}
