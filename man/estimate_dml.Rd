% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_functions.R
\name{estimate_dml}
\alias{estimate_dml}
\title{Cross-fitted estimation of pseudo-outcomes (Double ML)}
\usage{
estimate_dml(data, outcome, treatment, sample, crossfit = 5)
}
\arguments{
\item{data}{A data frame containing at least the outcome, treatment, and sample indicator columns.}

\item{outcome}{Name of the outcome column.}

\item{treatment}{Name of the treatment column (0/1).}

\item{sample}{Name of the sample indicator column (0/1).}

\item{crossfit}{Integer number of folds for cross-fitting (>= 2).}
}
\value{
A list with:
\item{df_v}{Data frame with one row per kept observation (indexed by \code{primary_index}),
containing: \code{te} (pseudo-outcome v), \code{a}, \code{b}, and squared deviations
\code{te_sq}, \code{a_sq}. Only S==1 rows with finite values are kept.}
\item{data2}{Subset of original \code{data} corresponding to \code{df_v$primary_index}.}
}
\description{
Trains nuisance models on each training fold and computes pseudo-outcomes on
the corresponding test fold, then aggregates results. Returns only what is
needed downstream: the pseudo-outcome table and the aligned evaluation data.
}
\note{
Rows with infinite or undefined weights (e.g., where the predicted propensity scores were 0 or 1) are removed from \code{df_v} (and the corresponding rows in \code{data2}). The \code{primary_index} in \code{df_v} corresponds to the row index in the original \code{data}.
Squared deviation columns (\code{te_sq}, \code{a_sq}) are centered around the mean of \code{te} and \code{a} for the \code{S==1} group.
}
\examples{
 sim<-get_data(n=2000,seed=599)
 dml<-estimate_dml(sim$data,outcome="Yobs",treatment="Tr",sample="S",crossfit= 5)
}
